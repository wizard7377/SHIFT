\usepackage{xstring}
\usepackage{xcolor}
\makeatletter

%Note, this file only defines complex macros, simple ones are listed in the preamble

\def\@lamedslist#1{\IfStrEq{}{#1}{}{\StrCut{#1}{ }\csA\csB\lamed\csA\@lamedslist\csB}}
\def\lameds#1 in #2.{\@lamedslist{#1} (#2)}

\def\@lamedslistofraw#1#2#3{{\IfStrEq{}{#1}{(#3)}{\StrCut{#1}{ }\csA\csB{(\@lamedslistofraw{\csB}{#2}{#3} : (\csA : #2))}}}}
\def\lamedsOfRaw#1 of #2 in #3.{\ensuremath{\@lamedslist{#1} \@lamedslistofraw{#1}{#2}{#3}}}
\def\@lamedslistof#1#2#3{\ensuremath {\IfStrEq{}{#1}{#3}{\StrCut{#1}{ }\csA\csB{#2[\csA] \Rightarrow \@lamedslistof{\csB}{#2}{#3}  }}}}
\def\lamedsOf#1 of #2 in #3.{\ensuremath{\@lamedslist{#1} (\@lamedslistof{#1}{#2}{#3})}}
\makeatother